define(["./when-b60132fc","./buildModuleUrl-8cce5713","./ArcType-f8a754c5","./arrayFill-4513d7ad","./Check-7b2a090c","./FeatureDetection-ab6f364c","./PolygonPipeline-f2f37e26","./GeometryAttribute-923c2729","./GeometryAttributes-252e9929","./PolygonGeometryLibrary-34d6c185","./GeometryOffsetAttribute-fbeb6f1a","./GeometryPipeline-54076c24","./IndexDatatype-3565e02d","./Math-31e539c2","./Cartesian4-b0ddc4ba","./WebGLConstants-aba9fc67","./Plane-5716a082","./earcut-2.2.1-20c8012f","./EllipsoidRhumbLine-3ee4574a","./AttributeCompression-399750a1","./EncodedCartesian3-ac3717ed"],(function(e,t,i,r,o,n,a,l,y,s,u,p,d,c,g,f,h,m,b,P,v){"use strict";var E=[],A=[];function _(e,r,o,u,p){var c,g,f=a.EllipsoidTangentPlane.fromPoints(r,e).projectPointsOntoPlane(r,E);a.PolygonPipeline.computeWindingOrder2D(f)===a.WindingOrder.CLOCKWISE&&(f.reverse(),r=r.slice().reverse());var h=r.length,m=0;if(u)for(c=new Float64Array(2*h*3),g=0;g<h;g++){var b=r[g],P=r[(g+1)%h];c[m++]=b.x,c[m++]=b.y,c[m++]=b.z,c[m++]=P.x,c[m++]=P.y,c[m++]=P.z}else{var v=0;if(p===i.ArcType.GEODESIC)for(g=0;g<h;g++)v+=s.PolygonGeometryLibrary.subdivideLineCount(r[g],r[(g+1)%h],o);else if(p===i.ArcType.RHUMB)for(g=0;g<h;g++)v+=s.PolygonGeometryLibrary.subdivideRhumbLineCount(e,r[g],r[(g+1)%h],o);for(c=new Float64Array(3*v),g=0;g<h;g++){var _;p===i.ArcType.GEODESIC?_=s.PolygonGeometryLibrary.subdivideLine(r[g],r[(g+1)%h],o,A):p===i.ArcType.RHUMB&&(_=s.PolygonGeometryLibrary.subdivideRhumbLine(e,r[g],r[(g+1)%h],o,A));for(var G=_.length,L=0;L<G;++L)c[m++]=_[L]}}var H=2*(h=c.length/3),T=d.IndexDatatype.createTypedArray(h,H);for(m=0,g=0;g<h-1;g++)T[m++]=g,T[m++]=g+1;return T[m++]=h-1,T[m++]=0,new s.GeometryInstance({geometry:new l.Geometry({attributes:new y.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:c})}),indices:T,primitiveType:t.PrimitiveType.LINES})})}function G(e,r,o,u,p){var c,g,f=a.EllipsoidTangentPlane.fromPoints(r,e).projectPointsOntoPlane(r,E);a.PolygonPipeline.computeWindingOrder2D(f)===a.WindingOrder.CLOCKWISE&&(f.reverse(),r=r.slice().reverse());var h=r.length,m=new Array(h),b=0;if(u)for(c=new Float64Array(2*h*3*2),g=0;g<h;++g){m[g]=b/3;var P=r[g],v=r[(g+1)%h];c[b++]=P.x,c[b++]=P.y,c[b++]=P.z,c[b++]=v.x,c[b++]=v.y,c[b++]=v.z}else{var _=0;if(p===i.ArcType.GEODESIC)for(g=0;g<h;g++)_+=s.PolygonGeometryLibrary.subdivideLineCount(r[g],r[(g+1)%h],o);else if(p===i.ArcType.RHUMB)for(g=0;g<h;g++)_+=s.PolygonGeometryLibrary.subdivideRhumbLineCount(e,r[g],r[(g+1)%h],o);for(c=new Float64Array(3*_*2),g=0;g<h;++g){var G;m[g]=b/3,p===i.ArcType.GEODESIC?G=s.PolygonGeometryLibrary.subdivideLine(r[g],r[(g+1)%h],o,A):p===i.ArcType.RHUMB&&(G=s.PolygonGeometryLibrary.subdivideRhumbLine(e,r[g],r[(g+1)%h],o,A));for(var L=G.length,H=0;H<L;++H)c[b++]=G[H]}}h=c.length/6;var T=m.length,D=2*(2*h+T),O=d.IndexDatatype.createTypedArray(h,D);for(b=0,g=0;g<h;++g)O[b++]=g,O[b++]=(g+1)%h,O[b++]=g+h,O[b++]=(g+1)%h+h;for(g=0;g<T;g++){var x=m[g];O[b++]=x,O[b++]=x+h}return new s.GeometryInstance({geometry:new l.Geometry({attributes:new y.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:c})}),indices:O,primitiveType:t.PrimitiveType.LINES})})}function L(r){var o=r.polygonHierarchy,n=e.defaultValue(r.ellipsoid,t.Ellipsoid.WGS84),a=e.defaultValue(r.granularity,c.Math3D.RADIANS_PER_DEGREE),l=e.defaultValue(r.perPositionHeight,!1),y=l&&e.defined(r.extrudedHeight),u=e.defaultValue(r.arcType,i.ArcType.GEODESIC),p=e.defaultValue(r.height,0),d=e.defaultValue(r.extrudedHeight,p);if(!y){var g=Math.max(p,d);d=Math.min(p,d),p=g}this._ellipsoid=t.Ellipsoid.clone(n),this._granularity=a,this._height=p,this._extrudedHeight=d,this._arcType=u,this._polygonHierarchy=o,this._perPositionHeight=l,this._perPositionHeightExtrude=y,this._offsetAttribute=r.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=s.PolygonGeometryLibrary.computeHierarchyPackedLength(o)+t.Ellipsoid.packedLength+8}L.pack=function(i,r,o){return o=e.defaultValue(o,0),o=s.PolygonGeometryLibrary.packPolygonHierarchy(i._polygonHierarchy,r,o),t.Ellipsoid.pack(i._ellipsoid,r,o),o+=t.Ellipsoid.packedLength,r[o++]=i._height,r[o++]=i._extrudedHeight,r[o++]=i._granularity,r[o++]=i._perPositionHeightExtrude?1:0,r[o++]=i._perPositionHeight?1:0,r[o++]=i._arcType,r[o++]=e.defaultValue(i._offsetAttribute,-1),r[o]=i.packedLength,r};var H=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),T={polygonHierarchy:{}};return L.unpack=function(i,r,o){r=e.defaultValue(r,0);var n=s.PolygonGeometryLibrary.unpackPolygonHierarchy(i,r);r=n.startingIndex,delete n.startingIndex;var a=t.Ellipsoid.unpack(i,r,H);r+=t.Ellipsoid.packedLength;var l=i[r++],y=i[r++],u=i[r++],p=1===i[r++],d=1===i[r++],c=i[r++],g=i[r++],f=i[r];return e.defined(o)||(o=new L(T)),o._polygonHierarchy=n,o._ellipsoid=t.Ellipsoid.clone(a,o._ellipsoid),o._height=l,o._extrudedHeight=y,o._granularity=u,o._perPositionHeight=d,o._perPositionHeightExtrude=p,o._arcType=c,o._offsetAttribute=-1===g?void 0:g,o.packedLength=f,o},L.fromPositions=function(t){return new L({polygonHierarchy:{positions:(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).positions},height:t.height,extrudedHeight:t.extrudedHeight,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,arcType:t.arcType,offsetAttribute:t.offsetAttribute})},L.createGeometry=function(i){var o=i._ellipsoid,y=i._granularity,d=i._polygonHierarchy,g=i._perPositionHeight,f=i._arcType,h=s.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(d,!g,o);if(0!==h.length){var m,b,P,v=[],E=c.Math3D.chordLength(y,o.maximumRadius),A=i._height,L=i._extrudedHeight;if(i._perPositionHeightExtrude||!c.Math3D.equalsEpsilon(A,L,0,c.Math3D.EPSILON2))for(P=0;P<h.length;P++){if((m=G(o,h[P],E,g,f)).geometry=s.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(m.geometry,A,L,o,g),e.defined(i._offsetAttribute)){var H=m.geometry.attributes.position.values.length/3,T=new Uint8Array(H);i._offsetAttribute===u.GeometryOffsetAttribute.TOP?T=r.arrayFill(T,1,0,H/2):(b=i._offsetAttribute===u.GeometryOffsetAttribute.NONE?0:1,T=r.arrayFill(T,b)),m.geometry.attributes.applyOffset=new l.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:T})}v.push(m)}else for(P=0;P<h.length;P++){if((m=_(o,h[P],E,g,f)).geometry.attributes.position.values=a.PolygonPipeline.scaleToGeodeticHeight(m.geometry.attributes.position.values,A,o,!g),e.defined(i._offsetAttribute)){var D=m.geometry.attributes.position.values.length,O=new Uint8Array(D/3);b=i._offsetAttribute===u.GeometryOffsetAttribute.NONE?0:1,r.arrayFill(O,b),m.geometry.attributes.applyOffset=new l.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}v.push(m)}var x=p.GeometryPipeline.combineInstances(v)[0],C=t.BoundingSphere.fromVertices(x.attributes.position.values);return new l.Geometry({attributes:x.attributes,indices:x.indices,primitiveType:x.primitiveType,boundingSphere:C,offsetAttribute:i._offsetAttribute})}},function(i,r){return e.defined(r)&&(i=L.unpack(i,r)),i._ellipsoid=t.Ellipsoid.clone(i._ellipsoid),L.createGeometry(i)}}));
