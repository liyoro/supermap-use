define(["./Cartesian4-b0ddc4ba","./when-b60132fc","./Math-31e539c2","./createTaskProcessorWorker","./Check-7b2a090c"],(function(r,a,e,t,n){"use strict";var i=new r.Cartesian4(1,1/255,1/65025,1/160581375),s=new r.Cartesian4,o=1024;function f(a,t,n,f,u,c,h){var v=a.longitude,d=a.latitude,C=a.height;if(v=e.Math3D.toDegrees(v),d=e.Math3D.toDegrees(d),v<t[0]||v>t[2]||d<t[1]||d>t[3])return-1;for(var g=!1,b=0,l=.1*f,p=0;p<=n;p+=f){if(Math.abs(u+p-C)<l){g=!0;break}b++}if(!g)return-1;if(c.length<0)return-1;g=!1;for(var D=0;D<c.length;D+=2){var k=r.Cartesian3.fromDegrees(v,d,C),m=r.Cartesian3.fromDegrees(c[D+0],c[D+1],C);if(r.Cartesian3.distance(k,m)<l){g=!0;break}}if(!g)return-1;var w=t[2]-t[0],M=(C=t[3]-t[1],t[0]-.025*w),x=t[1]-.025*C;w+=.05*w,C+=.05*C;var y=parseInt((v-M)/w*o),I=parseInt((d-x)/C*o);y=y<1?1:y,I=I<1?1:I;var P=h[b],z=0;for(D=-1;D<2;D++)for(var A=-1;A<2;A++){var B=4*(o*(I+A)+(y+D));s.x=P[B],s.y=P[B+1],s.z=P[B+2],s.w=P[B+3],r.Cartesian4.divideByScalar(s,255,s),z=Math.max(z,r.Cartesian4.dot(s,i))}return z=z>.999?1:z}return t((function(a,e){for(var t=a.points,n=a.enuPoints,i=a.bounds,s=a.extend,o=a.spacing,u=a.bottom,c=a.pixelsArray,h=[],v=0,d=t.length;v<d;v++){var C=t[v],g=f(r.Cartographic.fromCartesian(C),i,s,o,u,n,c);h.push({position:r.Cartesian3.clone(C),shadowRatio:g})}return{resultData:h}}))}));
